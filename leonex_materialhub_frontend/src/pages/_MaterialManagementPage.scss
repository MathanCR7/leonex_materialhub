@use "../scss/utils/variables" as var;
@use "../scss/utils/mixins" as mix;
@use "sass:color";

.material-management-page {
  animation: fadeIn 0.4s ease-out;
  display: flex;
  flex-direction: column;
  gap: var.$spacer-5;

  .page-header {
    display: flex;
    flex-direction: column;
    gap: var.$spacer-4;
    align-items: flex-start;

    .header-title h1 {
      font-size: 1.6rem;
      margin: 0;
      line-height: 1.2;
    }

    .page-subtitle {
      font-size: var.$font-size-base;
      color: var.$text-secondary;
      margin-top: var.$spacer-1;
    }

    .btn {
      width: 100%;
    }

    @include mix.screen-breakpoint(md) {
      flex-direction: row;
      justify-content: space-between;
      align-items: center;

      .header-title h1 {
        font-size: 1.8rem;
      }

      .btn {
        width: auto;
      }
    }
  }

  // --- UPDATED SEARCH BAR ---
  // .controls-bar removed because it was an empty ruleset

  .search-bar {
    position: relative;
    width: 100%;
    background-color: var.$surface-color;
    border-radius: var.$border-radius-lg;
    border: 1px solid var.$border-color;
    box-shadow: var.$box-shadow-sm;
    transition: all 150ms ease-in-out;
    display: flex; // To contain the elements

    &:focus-within {
      border-color: var.$primary;
      box-shadow: var.$box-shadow-focus;
    }

    .search-icon {
      position: absolute;
      top: 50%;
      left: var.$spacer-4;
      transform: translateY(-50%);
      color: var.$text-muted;
      pointer-events: none; // Allows clicking "through" the icon
      z-index: 1;
      font-size: 1.1em;
    }

    .search-input {
      border: none;
      background: transparent;
      padding: var.$spacer-3 var.$spacer-4;
      // Make space for the icon on the left
      padding-left: calc(var.$spacer-4 + var.$spacer-4 + 1em);
      width: 100%;
      font-size: var.$font-size-base;
      font-family: var.$font-family-sans;

      &:focus {
        outline: none;
      }
    }
  }

  // --- DATA TABLE STYLES ---
  .materials-table-container {
    background-color: transparent;
    box-shadow: none;
    border: none;
    padding: 0;

    @include mix.screen-breakpoint(md) {
      @include mix.card-style(0);
      overflow-x: auto;
    }
  }

  .materials-table {
    width: 100%;
    border-collapse: collapse;

    // --- MOBILE CARD VIEW (Default) ---
    thead {
      display: none;
    }

    tbody {
      display: flex;
      flex-direction: column;
      gap: var.$spacer-4;
    }

    tr {
      display: block;
      border: 1px solid var.$border-color;
      @include mix.card-style;
    }

    td {
      display: flex;
      justify-content: space-between;
      padding: var.$spacer-3 var.$spacer-4;
      text-align: right;
      border-bottom: 1px solid var.$border-color-light;
      white-space: normal;
      font-size: var.$font-size-sm;
      gap: var.$spacer-4;
      align-items: flex-start;
      overflow-wrap: break-word;
      word-break: break-word;

      &:last-child {
        border-bottom: none;
      }

      &::before {
        content: attr(data-label);
        font-weight: var.$font-weight-semibold;
        color: var.$text-secondary;
        text-align: left;
        flex-shrink: 0;
      }
    }

    // --- DESKTOP TABLE VIEW ---
    @include mix.screen-breakpoint(md) {
      min-width: 800px;

      thead {
        display: table-header-group;
      }

      tbody {
        display: table-row-group;
        gap: 0;
      }

      tr {
        display: table-row;
        background-color: transparent;
        border: none;
        box-shadow: none;
        border-radius: 0;
        padding: 0;
        transition: background-color 150ms ease;

        &:hover {
          background-color: var.$primary-light;
        }
      }

      th,
      td {
        display: table-cell;
        padding: var.$spacer-3 var.$spacer-4;
        text-align: left;
        border-bottom: 1px solid var.$border-color-light;
        white-space: nowrap;
        overflow-wrap: normal;
        word-break: normal;
        align-items: initial;
        gap: 0;

        &::before {
          display: none;
        }
      }

      th {
        background-color: var.$surface-light;
        font-weight: var.$font-weight-semibold;
        color: var.$text-secondary;
        cursor: pointer;
        -webkit-user-select: none;
        user-select: none;
        transition: background-color 150ms ease;
        &:hover {
          background-color: color.adjust(var.$surface-light, $lightness: -3%);
        }
      }
    }
  }

  .pagination-controls {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var.$spacer-4;
    padding: var.$spacer-3 0;

    @include mix.screen-breakpoint(md) {
      flex-direction: row;
      justify-content: space-between;
    }
  }

  // --- MODAL STYLES ---
  .modal-overlay {
    position: fixed;
    inset: 0;
    background-color: rgba(#0f172a, 0.7);
    z-index: var.$z-index-modal-overlay;
    padding: var.$spacer-4;
    animation: fadeIn 200ms ease-out;
    @include mix.flex-center;
  }

  .import-modal {
    width: 100%;
    max-width: 700px;
    display: flex;
    flex-direction: column;
    max-height: 90vh;
    animation: slideInUp 300ms ease-out;
    @include mix.card-style(0);

    .modal-body {
      padding: var.$spacer-5;
      overflow-y: auto;
    }

    .modal-actions {
      display: flex;
      flex-direction: column-reverse;
      gap: var.$spacer-3;
      padding: var.$spacer-4;
      border-top: 1px solid var.$border-color;
      background-color: var.$surface-light;
      flex-shrink: 0;

      .btn {
        width: 100%;
      }

      @include mix.screen-breakpoint(sm) {
        flex-direction: row;
        justify-content: flex-end;
        .btn {
          width: auto;
        }
      }
    }
  }
}